{"remainingRequest":"/Users/zuber/Desktop/document/company/mobile_ts/node_modules/babel-loader/lib/index.js!/Users/zuber/Desktop/document/company/mobile_ts/node_modules/ts-loader/index.js??ref--13-2!/Users/zuber/Desktop/document/company/mobile_ts/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zuber/Desktop/document/company/mobile_ts/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zuber/Desktop/document/company/mobile_ts/src/components/init.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/zuber/Desktop/document/company/mobile_ts/src/components/init.vue","mtime":1541501689446},{"path":"/Users/zuber/Desktop/document/company/mobile_ts/node_modules/cache-loader/dist/cjs.js","mtime":1540785597449},{"path":"/Users/zuber/Desktop/document/company/mobile_ts/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zuber/Desktop/document/company/mobile_ts/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/Users/zuber/Desktop/document/company/mobile_ts/node_modules/cache-loader/dist/cjs.js","mtime":1540785597449},{"path":"/Users/zuber/Desktop/document/company/mobile_ts/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.function.name\";\nimport _classCallCheck from \"/Users/zuber/Desktop/document/company/mobile_ts/node_modules/@babel/runtime/helpers/builtin/es6/classCallCheck\";\nimport _inherits from \"/Users/zuber/Desktop/document/company/mobile_ts/node_modules/@babel/runtime/helpers/builtin/es6/inherits\";\nimport _createClass from \"/Users/zuber/Desktop/document/company/mobile_ts/node_modules/@babel/runtime/helpers/builtin/es6/createClass\";\nimport _possibleConstructorReturn from \"/Users/zuber/Desktop/document/company/mobile_ts/node_modules/@babel/runtime/helpers/builtin/es6/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/zuber/Desktop/document/company/mobile_ts/node_modules/@babel/runtime/helpers/builtin/es6/getPrototypeOf\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.promise\";\nimport \"core-js/modules/es7.promise.finally\";\nimport * as tslib_1 from \"tslib\";\nimport { Component, Vue } from 'vue-property-decorator';\nimport { State, Action } from 'vuex-class';\nimport Platform from '@/utils/platform';\nimport { SHARE_INFO } from '@/model/index';\n\nvar InitApp =\n/*#__PURE__*/\nfunction (_Vue) {\n  function InitApp() {\n    var _this;\n\n    _classCallCheck(this, InitApp);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(InitApp).apply(this, arguments));\n    _this.ifWeixin = false;\n    _this.deviceInfo = '';\n    _this.shareInfo = SHARE_INFO;\n    return _this;\n  }\n\n  _createClass(InitApp, [{\n    key: \"created\",\n    value: function created() {\n      var platform = new Platform();\n      this.ifWeixin = platform.checkWeixin();\n      this.deviceInfo = platform.getDevice('mobile');\n    }\n  }, {\n    key: \"mounted\",\n    value: function mounted() {\n      this.deal();\n    } // 分享\n\n  }, {\n    key: \"share\",\n    value: function share() {\n      if (this.$route.name !== 'room') {\n        this.configShareInfo({\n          info: this.shareInfo\n        });\n      }\n    } // 重定向\n\n  }, {\n    key: \"redirect\",\n    value: function redirect(replace) {\n      if (!this.$route.name || this.$route.name === 'home') {\n        this.$router.push({\n          name: 'room',\n          query: {\n            share: this.$route.query.share,\n            shareUid: this.$route.query.shareUid\n          }\n        });\n      } else {\n        if (replace) {\n          replace();\n        }\n      }\n    } // 登录\n\n  }, {\n    key: \"login\",\n    value: function login() {\n      var _this2 = this;\n\n      this.getUserAuth({\n        info: this.$route.query,\n        success: function success() {\n          _this2.init();\n\n          _this2.redirect(function () {\n            _this2.$router.replace({\n              name: _this2.$route.name,\n              params: _this2.$route.params,\n              query: {\n                share: _this2.$route.query.share,\n                share_uid: _this2.$route.query.shareUid\n              }\n            });\n          });\n        }\n      });\n    }\n  }, {\n    key: \"reward\",\n    value: function reward() {\n      if (this.ifLogged && this.$route.query.share_uid) {\n        this.getShareBonus({\n          id: this.$route.query.shareUid\n        });\n      }\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      if (this.ifLogged) {\n        this.sendDeviceInfo({\n          info: this.deviceInfo\n        });\n        this.getUserInfo();\n        this.reward();\n      }\n    }\n  }, {\n    key: \"deal\",\n    value: function deal() {\n      this.share();\n      this.getAppInfo();\n\n      if (this.$route.query.state || this.$route.query.source) {\n        this.login();\n      } else if (!this.ifLogged) {\n        if (this.ifWeixin) {\n          window.location.href = 'http://www.zuber.im/weixin?' + (this.ifWeixin ? 'm=1&' : '') + 'goto=' + encodeURIComponent(window.location.href.replace('http:', 'https:'));\n        }\n      } else {\n        this.init();\n      }\n\n      this.redirect();\n    }\n  }]);\n\n  _inherits(InitApp, _Vue);\n\n  return InitApp;\n}(Vue);\n\ntslib_1.__decorate([State(function (state) {\n  return state.AuthModule.ifLogged;\n})], InitApp.prototype, \"ifLogged\", void 0);\n\ntslib_1.__decorate([Action('getUserAuth')], InitApp.prototype, \"getUserAuth\", void 0);\n\ntslib_1.__decorate([Action('getUserInfo')], InitApp.prototype, \"getUserInfo\", void 0);\n\ntslib_1.__decorate([Action('sendDeviceInfo')], InitApp.prototype, \"sendDeviceInfo\", void 0);\n\ntslib_1.__decorate([Action('getShareBonus')], InitApp.prototype, \"getShareBonus\", void 0);\n\ntslib_1.__decorate([Action('configShareInfo')], InitApp.prototype, \"configShareInfo\", void 0);\n\ntslib_1.__decorate([Action('getAppInfo')], InitApp.prototype, \"getAppInfo\", void 0);\n\nInitApp = tslib_1.__decorate([Component], InitApp);\nexport default InitApp;",{"version":3,"sources":["/Users/zuber/Desktop/document/company/mobile_ts/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zuber/Desktop/document/company/mobile_ts/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zuber/Desktop/document/company/mobile_ts/src/components/init.vue?vue&type=script&lang=ts&"],"names":[],"mappings":";;;;;;;;;;;AAKA,SAAS,SAAT,EAAoB,GAApB,QAA+B,wBAA/B;AACA,SAAS,KAAT,EAAgB,MAAhB,QAA8B,YAA9B;AACA,OAAO,QAAP,MAAqB,kBAArB;AACA,SAAS,UAAT,QAA2B,eAA3B;;AAGA,IAAA;AAAA;AAAA;AADA,qBAAA;AAAA;;AAAA;;;AAEU,UAAA,QAAA,GAAoB,KAApB;AACA,UAAA,UAAA,GAAqB,EAArB;AACA,UAAA,SAAA,GAAiB,UAAjB;AAJV;AA8FC;;AA7FD;AAAA;AAAA,8BAWiB;AACb,UAAM,WAAW,IAAI,QAAJ,EAAjB;AACA,WAAK,QAAL,GAAgB,SAAS,WAAT,EAAhB;AACA,WAAK,UAAL,GAAkB,SAAS,SAAT,CAAmB,QAAnB,CAAlB;AACD;AAfH;AAAA;AAAA,8BAgBiB;AACb,WAAK,IAAL;AACD,KAlBH,CAmBE;;AAnBF;AAAA;AAAA,4BAoBe;AACX,UAAI,KAAK,MAAL,CAAY,IAAZ,KAAqB,MAAzB,EAAiC;AAC/B,aAAK,eAAL,CAAqB;AACnB,gBAAM,KAAK;AADQ,SAArB;AAGD;AACF,KA1BH,CA2BE;;AA3BF;AAAA;AAAA,6BA4BmB,OA5BnB,EA4BgC;AAC5B,UAAI,CAAC,KAAK,MAAL,CAAY,IAAb,IAAqB,KAAK,MAAL,CAAY,IAAZ,KAAqB,MAA9C,EAAsD;AACpD,aAAK,OAAL,CAAa,IAAb,CAAkB;AAChB,gBAAM,MADU;AAEhB,iBAAO;AACL,mBAAO,KAAK,MAAL,CAAY,KAAZ,CAAkB,KADpB;AAEL,sBAAU,KAAK,MAAL,CAAY,KAAZ,CAAkB;AAFvB;AAFS,SAAlB;AAOD,OARD,MAQO;AACL,YAAI,OAAJ,EAAa;AACX;AACD;AACF;AACF,KA1CH,CA2CE;;AA3CF;AAAA;AAAA,4BA4Ce;AAAA;;AACX,WAAK,WAAL,CAAiB;AACf,cAAM,KAAK,MAAL,CAAY,KADH;AAEf,iBAAS,mBAAK;AACZ,iBAAK,IAAL;;AACA,iBAAK,QAAL,CAAc,YAAK;AACjB,mBAAK,OAAL,CAAa,OAAb,CAAqB;AACnB,oBAAM,OAAK,MAAL,CAAY,IADC;AAEnB,sBAAQ,OAAK,MAAL,CAAY,MAFD;AAGnB,qBAAO;AACL,uBAAO,OAAK,MAAL,CAAY,KAAZ,CAAkB,KADpB;AAEL,2BAAW,OAAK,MAAL,CAAY,KAAZ,CAAkB;AAFxB;AAHY,aAArB;AAQD,WATD;AAUD;AAdc,OAAjB;AAgBD;AA7DH;AAAA;AAAA,6BA8DgB;AACZ,UAAI,KAAK,QAAL,IAAiB,KAAK,MAAL,CAAY,KAAZ,CAAkB,SAAvC,EAAkD;AAChD,aAAK,aAAL,CAAmB;AACjB,cAAI,KAAK,MAAL,CAAY,KAAZ,CAAkB;AADL,SAAnB;AAGD;AACF;AApEH;AAAA;AAAA,2BAqEc;AACV,UAAI,KAAK,QAAT,EAAmB;AACjB,aAAK,cAAL,CAAoB;AAClB,gBAAM,KAAK;AADO,SAApB;AAGA,aAAK,WAAL;AACA,aAAK,MAAL;AACD;AACF;AA7EH;AAAA;AAAA,2BA8Ec;AACV,WAAK,KAAL;AACA,WAAK,UAAL;;AACA,UAAI,KAAK,MAAL,CAAY,KAAZ,CAAkB,KAAlB,IAA2B,KAAK,MAAL,CAAY,KAAZ,CAAkB,MAAjD,EAAyD;AACvD,aAAK,KAAL;AACD,OAFD,MAEO,IAAI,CAAC,KAAK,QAAV,EAAoB;AACzB,YAAI,KAAK,QAAT,EAAmB;AACjB,iBAAO,QAAP,CAAgB,IAAhB,GAAuB,iCAAiC,KAAK,QAAL,GAAgB,MAAhB,GAAyB,EAA1D,IAAgE,OAAhE,GACE,mBAAmB,OAAO,QAAP,CAAgB,IAAhB,CAAqB,OAArB,CAA6B,OAA7B,EAAsC,QAAtC,CAAnB,CADzB;AAED;AACF,OALM,MAKA;AACL,aAAK,IAAL;AACD;;AACD,WAAK,QAAL;AACD;AA5FH;;AAAA;;AAAA;AAAA,EAAqC,GAArC,CAAA;;AAIoD,QAAA,UAAA,CAAA,CAAjD,MAAM,UAAC,KAAD;AAAA,SAAgB,MAAM,UAAN,CAAiB,QAAjC;AAAA,CAAN,CAAiD,CAAA,E,iBAAA,E,UAAA,E,KAA2B,CAA3B;;AAC3B,QAAA,UAAA,CAAA,CAAtB,OAAO,aAAP,CAAsB,CAAA,E,iBAAA,E,aAAA,E,KAAyB,CAAzB;;AACA,QAAA,UAAA,CAAA,CAAtB,OAAO,aAAP,CAAsB,CAAA,E,iBAAA,E,aAAA,E,KAAyB,CAAzB;;AACG,QAAA,UAAA,CAAA,CAAzB,OAAO,gBAAP,CAAyB,CAAA,E,iBAAA,E,gBAAA,E,KAA4B,CAA5B;;AACD,QAAA,UAAA,CAAA,CAAxB,OAAO,eAAP,CAAwB,CAAA,E,iBAAA,E,eAAA,E,KAA2B,CAA3B;;AACE,QAAA,UAAA,CAAA,CAA1B,OAAO,iBAAP,CAA0B,CAAA,E,iBAAA,E,iBAAA,E,KAA6B,CAA7B;;AACL,QAAA,UAAA,CAAA,CAArB,OAAO,YAAP,CAAqB,CAAA,E,iBAAA,E,YAAA,E,KAAwB,CAAxB;;AAVH,UAAO,QAAA,UAAA,CAAA,CAD3B,SAC2B,CAAA,EAAP,OAAO,CAAP;eAAA,O","sourcesContent":["\n\n\n\n\nimport { Component, Vue } from 'vue-property-decorator';\nimport { State, Action } from 'vuex-class';\nimport Platform from '@/utils/platform';\nimport { SHARE_INFO } from '@/model/index';\n\n@Component\nexport default class InitApp extends Vue {\n  private ifWeixin: boolean = false;\n  private deviceInfo: string = '';\n  private shareInfo: any = SHARE_INFO;\n  @State((state: any) => state.AuthModule.ifLogged) private ifLogged!: boolean;\n  @Action('getUserAuth') private getUserAuth: any;\n  @Action('getUserInfo') private getUserInfo: any;\n  @Action('sendDeviceInfo') private sendDeviceInfo: any;\n  @Action('getShareBonus') private getShareBonus: any;\n  @Action('configShareInfo') private configShareInfo: any;\n  @Action('getAppInfo') private getAppInfo: any;\n  private created(): void {\n    const platform = new Platform();\n    this.ifWeixin = platform.checkWeixin();\n    this.deviceInfo = platform.getDevice('mobile');\n  }\n  private mounted(): void {\n    this.deal();\n  }\n  // 分享\n  private share(): void {\n    if (this.$route.name !== 'room') {\n      this.configShareInfo({\n        info: this.shareInfo,\n      });\n    }\n  }\n  // 重定向\n  private redirect(replace?: any): void {\n    if (!this.$route.name || this.$route.name === 'home') {\n      this.$router.push({\n        name: 'room',\n        query: {\n          share: this.$route.query.share,\n          shareUid: this.$route.query.shareUid,\n        },\n      });\n    } else {\n      if (replace) {\n        replace();\n      }\n    }\n  }\n  // 登录\n  private login(): void {\n    this.getUserAuth({\n      info: this.$route.query,\n      success: () => {\n        this.init();\n        this.redirect(() => {\n          this.$router.replace({\n            name: this.$route.name,\n            params: this.$route.params,\n            query: {\n              share: this.$route.query.share,\n              share_uid: this.$route.query.shareUid,\n            },\n          });\n        });\n      },\n    });\n  }\n  private reward(): void {\n    if (this.ifLogged && this.$route.query.share_uid) {\n      this.getShareBonus({\n        id: this.$route.query.shareUid,\n      });\n    }\n  }\n  private init(): void {\n    if (this.ifLogged) {\n      this.sendDeviceInfo({\n        info: this.deviceInfo,\n      });\n      this.getUserInfo();\n      this.reward();\n    }\n  }\n  private deal(): void {\n    this.share();\n    this.getAppInfo();\n    if (this.$route.query.state || this.$route.query.source) {\n      this.login();\n    } else if (!this.ifLogged) {\n      if (this.ifWeixin) {\n        window.location.href = 'http://www.zuber.im/weixin?' + (this.ifWeixin ? 'm=1&' : '') + 'goto='\n                               + encodeURIComponent(window.location.href.replace('http:', 'https:'));\n      }\n    } else {\n      this.init();\n    }\n    this.redirect();\n  }\n}\n"],"sourceRoot":""}]}